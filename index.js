(()=>{"use strict";var e={d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{a:()=>d});const t=class{draw(e){const t=e,r=document.createDocumentFragment(),s=document.querySelector("#cardTemplate");return t.forEach(((e,t)=>{const o=s.content.cloneNode(!0);o.id=`${e.id}`,o.querySelector(".card__body-photo").style.backgroundImage=`url(${e.thumbnail})`,o.querySelector(".card__body-title").textContent=e.title,o.querySelector(".list__item-category").textContent=`Category ${e.category}`,o.querySelector(".list__item-brand").textContent=`Brand: ${e.brand}`,o.querySelector(".list__item-price").textContent=`Price: ${e.price}`,o.querySelector(".list__item-rating").textContent=`Rating: ${e.rating}`,o.querySelector(".list__item-stock").textContent=`Stock: ${e.stock} `,o.querySelector(".card__link-details").href=`#product-details/${e.id}`,r.append(o)})),r}},r=["category","brand","price","stock"],s=class{constructor(){this.storage=new class{constructor(e){this.store=e,this.obj=this.getAll()}set(e,t){const r=this.obj;r[e]=t;const s=JSON.stringify(r);localStorage.setItem(this.store,s)}get(e){return this.obj[e]}getAll(){const e=localStorage.getItem(this.store);return e?JSON.parse(e):{}}dropAll(){localStorage.clear()}}("shop")}listen=()=>{const e=document.querySelector(".filters__box");r.forEach((e=>{const t=this.storage.get(`${e}`)||[];t.length>0&&this.addChecked(t,e)})),e.addEventListener("change",(e=>{if(r.includes(e.target.name)){const t=document.querySelectorAll(`[name=${e.target.name}]:checked`),s=[];t.forEach((e=>s.push(e.value))),this.storage.set(`${e.target.name}`,s);const o=this.storage.getAll();let a="#?/";return r.forEach(((e,t)=>{o[e]&&o[e].length>0&&(a+=`${t>0&&a.length>3?"&":""}${e}=${o[e].join("+")}`)})),window.location.hash=3===a.length?"":a}}))};addChecked=(e,t)=>{document.querySelectorAll(`[name=${t}]`).forEach((t=>{e.includes(t.value)&&(t.checked=!0)}))}};class o{constructor(e){this.params=e}setTitle(e){document.title=e}async render(){return""}}const a=class{static checkId=e=>{const t=e.split("/");return console.log(t),2===t.length&&Number(t.slice(-1).join(""))};static setFilter=e=>{}};class n extends o{constructor(e){super(e),this.setTitle("Home"),this.productsView=new t,this.listener=new s}async getCategoryProducts(){a.setFilter(this.params);const e=[],t=await d;return this.productsView.draw(t.products.filter((t=>e.includes(t.category))))}async afterRootRender(){const e=await this.getCategoryProducts();document.querySelector(".products__wrapper").append(e),this.listener.listen()}async render(e){e.innerHTML='<section class="products container"><aside class="products__filter"><div class="filters__box"><div id="category"><h3>Category</h3>   <div><input        type="checkbox" id="smartphones" name="category" value="smartphones"/><label for="smartphones">Smartphones</label></div><div>      <input type="checkbox" id="laptops" name="category" value="laptops"/><label for="laptops">Laptops</label></div></div><div id="brand"><div><h3>Brand</h3><input type="checkbox" id="apple" name="brand" value="apple"/><label for="apple">Apple</label></div><div>      <input type="checkbox" id="samsung" name="brand" value="samsung"/><label for="samsung">Samsung</label></div></div></aside><div class="products__wrapper"></div></section>',await this.afterRootRender()}}class c extends o{constructor(e){super(e),this.setTitle("Home"),this.productsView=new t,this.listener=new s}async afterRootRender(){const e=await d,t=this.productsView.draw(e.products);document.querySelector(".products__wrapper").append(t),this.listener.listen()}async render(e){e.innerHTML='<section class="products container"><aside class="products__filter"><div class="filters__box"><div id="category"><h3>Category</h3>   <div><input        type="checkbox" id="smartphones" name="category" value="smartphones"/><label for="smartphones">Smartphones</label></div><div>      <input type="checkbox" id="laptops" name="category" value="laptops"/><label for="laptops">Laptops</label></div></div><div id="brand"><div><h3>Brand</h3><input type="checkbox" id="apple" name="brand" value="apple"/><label for="apple">Apple</label></div><div>      <input type="checkbox" id="samsung" name="brand" value="samsung"/><label for="samsung">Samsung</label></div></div></aside><div class="products__wrapper"></div></section>',await this.afterRootRender()}async search(e){const t=document.querySelector(".search__input").value;return(await e).products.filter((e=>{for(let r in e)if("string"==typeof e[r]&&e[r].toUpperCase().includes(t.toUpperCase()))return!0;return!1}))}}class i extends o{constructor(e){super(e),this.productId=e,this.setTitle("Product Details"),this.productsView=new t}showIncorrect(){const e=document.createElement("div");return e.classList.add("not-found"),e.textContent=`Product number\n  ${this.productId.split("/").slice(-1).join("")}\n    not found`,e}async getItem(){const e=a.checkId(this.productId);if(e){const t=(await d).products.filter((t=>t.id===e));return t.length>0?this.productsView.draw(t):this.showIncorrect()}return this.showIncorrect()}async executeViewScript(){const e=await this.getItem();document.querySelector("#root .container").append(e)}async render(e){e.innerHTML='<div class="container"></div>',await this.executeViewScript()}}const l=class extends o{constructor(e){super(e)}render(e){console.log(this.params);const t=document.createElement("div");t.classList.add("error-page");const r=document.createElement("div");r.textContent="404",t.append(r),e.append(t)}},d=class{static async getData(e){const t=await fetch(e);return await t.json()}}.getData("https://dummyjson.com/products"),u=new class{constructor(){this.root=document.querySelector("#root")}router(){const e=[{path:"/",view:c},{path:"#product-details",view:i},{path:"#?",view:n}],t=location.hash.toLocaleLowerCase()||"/",r=(()=>{if("/"===t)return 0;{const r=t.split("/").slice(0,1).join("");let s;return console.log(r),e.forEach(((e,t)=>{e.path.startsWith(r)&&(s=t)})),s}})(),s=r>=0?new e[r].view(t):new l(t);this.root.innerHTML="",s.render(this.root)}navigateTo(e){history.pushState(null,null,e),this.router()}};localStorage.removeItem("shop"),window.addEventListener("popstate",u.router),document.addEventListener("DOMContentLoaded",(()=>{document.body.addEventListener("click",(e=>{e.target.matches("[data-link]")&&(e.preventDefault(),u.navigateTo(e.target.href))})),u.router()})),document.querySelector(".search__input").addEventListener("input",(e=>{e.preventDefault(),u.router()}))})();
//# sourceMappingURL=index.js.map